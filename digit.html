<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digit</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: #fff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 500px;
            width: 100%;
        }

        h1 {
            font-size: 1.5em;
            margin-bottom: 20px;
            text-align: center;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #000;
        }

        .mode-indicator {
            text-align: center;
            padding: 10px;
            margin-bottom: 15px;
            font-weight: bold;
            border: 1px solid #000;
        }

        .mode-indicator.reverse {
            background: #000;
            color: #fff;
        }

        .display-area {
            height: 150px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid #000;
            margin-bottom: 15px;
        }

        .digit-display {
            font-size: 5em;
            font-family: monospace;
            font-weight: bold;
        }

        .digit-display.hidden {
            visibility: hidden;
        }

        .status {
            text-align: center;
            margin-bottom: 15px;
            height: 24px;
            font-weight: bold;
        }

        .input-display {
            font-size: 1.5em;
            font-family: monospace;
            letter-spacing: 8px;
            text-align: center;
            padding: 15px;
            border: 1px solid #000;
            margin-bottom: 15px;
            min-height: 54px;
        }

        .numpad {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .num-btn {
            padding: 15px;
            font-size: 1.4em;
            font-weight: bold;
            background: #fff;
            border: 1px solid #000;
            cursor: pointer;
        }

        .num-btn:hover {
            background: #eee;
        }

        .num-btn:disabled {
            opacity: 0.5;
            cursor: default;
        }

        .action-row {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .action-btn {
            flex: 1;
            padding: 12px;
            font-size: 1em;
            border: 1px solid #000;
            cursor: pointer;
        }

        .clear-btn {
            background: #fff;
        }

        .submit-btn {
            background: #000;
            color: #fff;
        }

        .submit-btn:hover {
            background: #333;
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: default;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 15px;
            text-align: center;
        }

        .stat-box {
            padding: 10px;
            border: 1px solid #000;
        }

        .stat-label {
            font-size: 0.8em;
        }

        .stat-value {
            font-size: 1.2em;
            font-weight: bold;
        }

        .controls {
            text-align: center;
        }

        .start-btn {
            padding: 12px 30px;
            font-size: 1em;
            background: #000;
            color: #fff;
            border: none;
            cursor: pointer;
        }

        .start-btn:hover {
            background: #333;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #000;
            text-decoration: none;
        }

        .back-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">‚Üê Back</a>
        <h1>Digit</h1>

        <div class="info-row">
            <span>Level: <span id="level">1</span></span>
            <span>Length: <span id="length">3</span></span>
            <span>Round: <span id="round">1</span></span>
        </div>

        <div class="mode-indicator" id="modeIndicator">
            Forward - Enter in same order
        </div>

        <div class="display-area">
            <div class="digit-display" id="digitDisplay">?</div>
        </div>

        <div class="status" id="status">Press Start to begin</div>

        <div class="input-display" id="inputDisplay"></div>

        <div class="numpad">
            <button class="num-btn" onclick="addDigit('0')" disabled>0</button>
            <button class="num-btn" onclick="addDigit('1')" disabled>1</button>
            <button class="num-btn" onclick="addDigit('2')" disabled>2</button>
            <button class="num-btn" onclick="addDigit('3')" disabled>3</button>
            <button class="num-btn" onclick="addDigit('4')" disabled>4</button>
            <button class="num-btn" onclick="addDigit('5')" disabled>5</button>
            <button class="num-btn" onclick="addDigit('6')" disabled>6</button>
            <button class="num-btn" onclick="addDigit('7')" disabled>7</button>
            <button class="num-btn" onclick="addDigit('8')" disabled>8</button>
            <button class="num-btn" onclick="addDigit('9')" disabled>9</button>
        </div>

        <div class="action-row">
            <button class="action-btn clear-btn" onclick="clearInput()" id="clearBtn" disabled>Clear</button>
            <button class="action-btn submit-btn" onclick="submitAnswer()" id="submitBtn" disabled>Submit</button>
        </div>

        <div class="stats">
            <div class="stat-box">
                <div class="stat-label">Score</div>
                <div class="stat-value" id="score">0</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Correct</div>
                <div class="stat-value" id="correct">0</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Accuracy</div>
                <div class="stat-value" id="accuracy">100%</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">Best</div>
                <div class="stat-value" id="best">1</div>
            </div>
        </div>

        <div class="controls">
            <button class="start-btn" id="startBtn" onclick="startGame()">Start Game</button>
        </div>
    </div>

    <script>
        let gameState = {
            isPlaying: false,
            sequence: [],
            userInput: '',
            level: 1,
            round: 1,
            score: 0,
            correct: 0,
            total: 0,
            best: 1,
            isReverse: false,
            showingSequence: false
        };

        function getSequenceLength() {
            return Math.min(3 + Math.floor((gameState.level - 1) / 2), 12);
        }

        function generateSequence() {
            const length = getSequenceLength();
            gameState.sequence = [];
            for (let i = 0; i < length; i++) {
                gameState.sequence.push(Math.floor(Math.random() * 10));
            }
        }

        async function showSequence() {
            gameState.showingSequence = true;
            setInputEnabled(false);
            
            const display = document.getElementById('digitDisplay');
            document.getElementById('status').textContent = 'Watch...';
            
            await delay(800);
            
            for (let i = 0; i < gameState.sequence.length; i++) {
                display.textContent = gameState.sequence[i];
                display.classList.remove('hidden');
                await delay(700);
                display.classList.add('hidden');
                await delay(300);
            }
            
            display.textContent = '?';
            display.classList.remove('hidden');
            
            const order = gameState.isReverse ? 'REVERSE' : 'same';
            document.getElementById('status').textContent = 'Enter in ' + order + ' order';
            
            gameState.showingSequence = false;
            setInputEnabled(true);
        }

        function setInputEnabled(enabled) {
            document.querySelectorAll('.num-btn').forEach(btn => btn.disabled = !enabled);
            document.getElementById('submitBtn').disabled = !enabled;
            document.getElementById('clearBtn').disabled = !enabled;
        }

        function addDigit(d) {
            if (!gameState.isPlaying || gameState.showingSequence) return;
            if (gameState.userInput.length < getSequenceLength()) {
                gameState.userInput += d;
                document.getElementById('inputDisplay').textContent = gameState.userInput;
            }
        }

        function clearInput() {
            gameState.userInput = '';
            document.getElementById('inputDisplay').textContent = '';
        }

        function submitAnswer() {
            if (!gameState.isPlaying || gameState.showingSequence) return;
            if (gameState.userInput.length !== gameState.sequence.length) {
                document.getElementById('status').textContent = 'Enter all ' + gameState.sequence.length + ' digits';
                return;
            }
            
            checkAnswer();
        }

        function checkAnswer() {
            const expected = gameState.isReverse ? 
                [...gameState.sequence].reverse() : 
                gameState.sequence;
            
            const isCorrect = gameState.userInput === expected.join('');
            gameState.total++;
            
            const status = document.getElementById('status');
            
            if (isCorrect) {
                gameState.correct++;
                gameState.score += gameState.level * 10;
                status.textContent = 'Correct! +' + (gameState.level * 10);
                
                setTimeout(() => {
                    if (gameState.isPlaying) {
                        gameState.level++;
                        if (gameState.level > gameState.best) {
                            gameState.best = gameState.level;
                        }
                        if (gameState.level === 2) {
                            gameState.round = 2;
                        }
                        startLevel();
                    }
                }, 1200);
            } else {
                status.textContent = 'Wrong. Was: ' + expected.join('');
                
                setTimeout(() => {
                    if (gameState.isPlaying) {
                        if (gameState.level > 1) {
                            gameState.level--;
                        }
                        startLevel();
                    }
                }, 2000);
            }
            
            updateStats();
        }

        function startLevel() {
            clearInput();
            generateSequence();
            updateDisplay();
            
            setTimeout(() => {
                showSequence();
            }, 500);
        }

        function updateDisplay() {
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('length').textContent = getSequenceLength();
            document.getElementById('round').textContent = gameState.round;
            
            const modeEl = document.getElementById('modeIndicator');
            if (gameState.level >= 2) {
                gameState.isReverse = true;
                modeEl.textContent = 'REVERSE - Enter in reverse order';
                modeEl.className = 'mode-indicator reverse';
            } else {
                gameState.isReverse = false;
                modeEl.textContent = 'Forward - Enter in same order';
                modeEl.className = 'mode-indicator';
            }
        }

        function updateStats() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('correct').textContent = gameState.correct;
            document.getElementById('best').textContent = gameState.best;
            
            const accuracy = gameState.total > 0 ? 
                Math.round((gameState.correct / gameState.total) * 100) : 100;
            document.getElementById('accuracy').textContent = accuracy + '%';
        }

        function startGame() {
            if (gameState.isPlaying) {
                stopGame();
                return;
            }
            
            gameState.isPlaying = true;
            gameState.level = 1;
            gameState.round = 1;
            gameState.score = 0;
            gameState.correct = 0;
            gameState.total = 0;
            gameState.isReverse = false;
            
            document.getElementById('startBtn').textContent = 'Stop';
            
            updateStats();
            startLevel();
        }

        function stopGame() {
            gameState.isPlaying = false;
            
            document.getElementById('startBtn').textContent = 'Start Game';
            document.getElementById('status').textContent = 'Stopped';
            
            setInputEnabled(false);
            clearInput();
        }

        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        document.addEventListener('keydown', (e) => {
            if (!gameState.isPlaying || gameState.showingSequence) return;
            
            if (e.key >= '0' && e.key <= '9') {
                addDigit(e.key);
            } else if (e.key === 'Enter') {
                submitAnswer();
            } else if (e.key === 'Backspace') {
                gameState.userInput = gameState.userInput.slice(0, -1);
                document.getElementById('inputDisplay').textContent = gameState.userInput;
            } else if (e.key === 'Escape') {
                clearInput();
            }
        });

        updateStats();
        updateDisplay();
    </script>
</body>
</html>
